<div class="tabs-container">
    <mat-tab-group>
        <mat-tab label="Dashboard">
            <div class="grid-container">
                <div class="dashboard-grid">
                    <div class="total-container grid-element">
                        <h3 class="element-title">Valor Total:</h3>
                        <h2 class="element-value">{{accountInfo?.totalValue | number:'1.2-2'}}€</h2>
                    </div> 
                    <div class="lucros-container grid-element">
                        <h3 class="element-title">Entradas:</h3>
                        <h2 class="element-value">{{accountInfo?.income | number:'1.2-2'}}€</h2>
                        <button mat-mini-fab color="primary" class="add-value-button" (click)="changeValue(0)">
                            <mat-icon>add</mat-icon>
                        </button>
                    </div>
                    <div class="despesas-container grid-element">
                        <h3 class="element-title">Saídas:</h3>
                        <h2 class="element-value">{{accountInfo?.expenses | number:'1.2-2'}}€</h2>
                        <button mat-mini-fab color="primary" class="add-value-button" (click)="changeValue(1)">
                            <mat-icon>add</mat-icon>
                        </button>
                    </div>
                    <div class="mao-container grid-element">
                        <h3 class="element-title">Valor em mão:</h3>
                        <h2 class="element-value">{{accountInfo?.handTotal | number:'1.2-2'}}€</h2>
                        <div class="add-value-button">
                            <button mat-mini-fab color="primary" class="transfer-value-button" (click)="changeValue(3)">
                                <mat-icon>compare_arrows</mat-icon>
                            </button>
                            <button mat-mini-fab color="primary" class="add-value-button" (click)="changeValue(2)">
                                <mat-icon>add</mat-icon>
                            </button>
                        </div>
                    </div>
                    <div class="conta-container grid-element">
                            <h3 class="element-title">valor conta:</h3>
                            <h2 class="element-value">{{accountInfo?.accountTotal | number:'1.2-2'}}€</h2>
                    </div>
                </div>
            </div>
        </mat-tab>
        <mat-tab label="Quotas"> 
            <div class="select-month">
                <mat-form-field>
                    <mat-label>Seleciona um mês</mat-label>
                    <mat-select [(ngModel)]="selectedMonth" name="month" (selectionChange)="monthChanged()">
                        <mat-option *ngFor="let mes of meses" [value]="mes.id">
                            {{mes.mes}}
                        </mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <mat-form-field>
                <mat-label>Procurar</mat-label>
                <input matInput (change)="applyFilter($event)" placeholder="Nome" #input>
            </mat-form-field>
            <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

                <ng-container matColumnDef="type">
                    <th mat-header-cell *matHeaderCellDef >Tipo de utilizador</th>
                    <td mat-cell *matCellDef="let element">{{element.type}}</td>
                </ng-container>

                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef >Nome</th>
                    <td mat-cell *matCellDef="let element">{{element.name}}</td>
                </ng-container>

                <ng-container matColumnDef="paymentStatus">
                    <th mat-header-cell *matHeaderCellDef>Estado do pagamento</th>
                    <td mat-cell *matCellDef="let element">{{element.paymentStatus ? '✅' : '❌'}}</td>
                </ng-container>

                <ng-container matColumnDef="paymentDate">
                    <th mat-header-cell *matHeaderCellDef >Data de pagamento</th>
                    <td mat-cell *matCellDef="let element">{{!element.paymentDate ? '-' : element.paymentDate | date:'longDate'}}</td>
                </ng-container>

                <ng-container matColumnDef="fine">
                    <th mat-header-cell *matHeaderCellDef>Multa</th>
                    <td mat-cell *matCellDef="let element">{{element.fine || element.fine === 0 ? element.fine + "€" : '-'}}</td>
                </ng-container>

                <ng-container matColumnDef="opt">
                    <th mat-header-cell *matHeaderCellDef></th>
                    <td mat-cell *matCellDef="let element">
                        <button mat-icon-button [matMenuTriggerFor]="menu" [matMenuTriggerData]="{elem: element}" aria-label="Example icon button with a vertical three dot icon">
                            <mat-icon>more_vert</mat-icon>
                        </button>
                        <mat-menu #menu="matMenu">
                            <ng-template matMenuContent let-elem="elem">
                                <button mat-menu-item (click)="seeAccount(elem)">
                                    <mat-icon>account_circle</mat-icon>
                                    <span>Ver conta</span>
                                </button>
                                <button mat-menu-item (click)="addPayment(elem)">
                                    <mat-icon>check_circle</mat-icon>
                                    <span>Adicionar pagamento</span>
                                </button>
                                <button mat-menu-item (click)="deletePayment(elem)">
                                    <mat-icon>delete</mat-icon>
                                    <span>Remover pagamento</span>
                                </button>
                            </ng-template>
                        </mat-menu>
                    </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row 
                    *matRowDef="let row; columns: displayedColumns;"></tr>
                
            </table>  
        </mat-tab>
        <mat-tab label="Eventos"> 
            <div class="add-event-button-container">
                <button mat-flat-button (click)="openEventCreator()" color="primary" class="add-event-button">
                    Adicionar Evento
                </button>
            </div>
            <mat-accordion *ngFor="let event of eventList">
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            <div class="has-event" [ngStyle]="{'background-color':getColorForEvent(event)}"></div> 
                            {{event.titulo}}
                        </mat-panel-title>
                        <mat-panel-description class="mat-panel-description">
                            <mat-icon>access_time</mat-icon>
                            {{event.data | date:'shortTime'}}
                        </mat-panel-description>
                    </mat-expansion-panel-header>
                    <div class="event-container">
                        {{event.descricao}}
                    </div>
                    <div class="delete-event-button">
                        <button mat-raised-button (click)="deleteEvent(event)" >Eliminar Evento</button>
                    </div>
                </mat-expansion-panel>
            </mat-accordion>
        </mat-tab>
        <mat-tab label="Utilizadores" *ngIf="usersToActivate && usersToActivate.length > 0"> 
            <h2>Utilizadores por Ativar</h2>
            <mat-nav-list>
                <a *ngFor="let user of usersToActivate" mat-list-item (click)="finishRegisterUser(user)" class="user-button">{{user.name}}</a>
            </mat-nav-list>
        </mat-tab>
    </mat-tab-group>
</div>
